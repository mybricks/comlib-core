!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.fn=e():t.fn=e()}(this,(function(){return function(){"use strict";var __webpack_modules__={356:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){function __WEBPACK_DEFAULT_EXPORT__(_a){var data=_a.data,outputs=_a.outputs,inputs=_a.inputs,onError=_a.onError;inputs.from((function(val,relOutpus){var _a,script=null===(_a=data.exchange)||void 0===_a?void 0:_a.script;if(script){var fn=void 0,returnVal=void 0,isOk=void 0;try{eval("fn = ".concat(script)),returnVal=fn(val),isOk=!0}catch(t){console.error(t),onError("数据转换错误:".concat(t.message),t)}isOk&&outputs.to(returnVal)}else onError("未配置转换规则")}))}__webpack_require__.d(__webpack_exports__,{Z:function(){return __WEBPACK_DEFAULT_EXPORT__}})}},__webpack_module_cache__={};function __webpack_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var n=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t](n,n.exports,__webpack_require__),n.exports}__webpack_require__.d=function(t,e){for(var n in e)__webpack_require__.o(e,n)&&!__webpack_require__.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},__webpack_require__.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},__webpack_require__.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var __webpack_exports__={};return function(){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:function(){return N},getCom:function(){return I}});var t=JSON.parse('{"title":"Fn计算","namespace":"mybricks.core-comlib.fn","author":"CheMingjun","author_name":"车明君","version":"1.0.0","description":"Fn计算","icon":"./icon.png","runtime":"./Fn.tsx","rtType":"js","visibility":false}'),e=JSON.parse('{"visibility":false,"title":"变量","namespace":"mybricks.core-comlib.var","author":"CheMingjun","author_name":"车明君","version":"1.0.0","description":"变量","icon":"./icon.png","data":"./data.json","runtime":"./Var.tsx","editors":"./editors.tsx","rtType":"js","inputs":[{"id":"get","title":"读取","schema":{"type":"any"},"rels":["return"]},{"id":"set","title":"赋值","schema":{"type":"follow"},"rels":["return"]},{"id":"reset","title":"重置","schema":{"type":"any"}}],"outputs":[{"id":"return","title":"完成","schema":{"type":"unknown"}},{"id":"changed","title":"当值发生变化","schema":{"type":"unknown"}}]}');function n(t,e){void 0===e&&(e=[]);try{var r=Object.prototype.toString.call(t);if(null===t||"object"!=typeof t||r.startsWith("[object HTML")||"[object FormData]"===r)return t;var o=e.filter((function(e){return e.original===t}))[0];if(o)return o.copy;var i=Array.isArray(t)?[]:{};return e.push({original:t,copy:i}),Object.keys(t).forEach((function(r){i[r]=n(t[r],e)})),i}catch(e){return t}}var r=JSON.parse('{"title":"类型转换","visibility":false,"namespace":"mybricks.core-comlib.type-change","author":"CheMingjun","author_name":"车明君","version":"1.0.0","description":"类型转换","icon":"./icon.png","runtime":"./rt.tsx","editors":"./editors.tsx","rtType":"js","inputs":[{"id":"from","title":"从","schema":{"type":"follow"},"rels":["to"]}],"outputs":[{"id":"to","title":"到","schema":{"type":"follow"},"conMax":1,"editable":true}]}'),o=__webpack_require__(356),i=JSON.parse('{"deprecated":true,"visibility":false,"title":"连接器","namespace":"mybricks.core-comlib.connector","author":"MyBricks","author_name":"MyBricks","version":"1.0.0","description":"连接器","runtime":"./runtime.ts","editors":"./editors.tsx","icon":"./icon.svg","rtType":"js-autorun","inputs":[{"id":"call","rels":["then","catch"],"title":"调用","schema":{"type":"object"}}],"outputs":[{"id":"then","title":"结果","schema":{"type":"unknown"}},{"id":"catch","title":"发生错误","schema":{"type":"string"}}]}');function a(t,e){var n=t.env,r=t.data,o=t.outputs;if(t.onError,void 0===e&&(e={}),r.connector)try{n.callConnector(r.connector,e,r.connectorConfig).then((function(t){o.then(t)})).catch((function(t){o.catch(t)}))}catch(t){console.error(t),o.catch("执行错误 ".concat(t.message||t))}else o.catch("没有选择接口")}var c=JSON.parse('{"visibility":false,"title":"作用域输入","namespace":"mybricks.core-comlib.frame-input","author":"CheMingjun","author_name":"车明君","version":"1.0.0","description":"作用域输入","rtType":"js","runtime":"./runtime.ts","editors":"./editor.tsx","inputs":[{"id":"getCurValue","title":"获取","schema":{"type":"any"},"rels":["return"]}],"outputs":[{"id":"return","title":"结果","schema":{"type":"follow"}}]}'),s=JSON.parse('{"visibility":false,"title":"打开对话框","namespace":"mybricks.core-comlib.scenes","author":"CheMingjun","author_name":"车明君","version":"1.0.0","description":"切换场景","icon":"./icon.png","runtime":"./runtime.ts","data":"./data.json","rtType":"js","inputs":[{"id":"open","title":"打开","schema":{"type":"any"}}]}'),u=JSON.parse('{"title":"模块","namespace":"mybricks.core-comlib.module","author":"CheMingjun","author_name":"车明君","version":"1.0.0","description":"模块","icon":"./icon.png","data":"./data.json","runtime":"./runtime.tsx","editors":"./editors.ts","outputs":[{"id":"click","title":"单击","description":"点击模块触发的事件","schema":{"type":"any"}}]}'),p=JSON.parse('{"title":"服务Fx","namespace":"mybricks.core-comlib.service","author":"CheMingjun","author_name":"车明君","version":"1.0.0","description":"服务Fx","icon":"./icon.png","runtime":"./Service.tsx","rtType":"js","visibility":false}'),l=JSON.parse('{"title":"JS-AI","namespace":"mybricks.core-comlib.js-ai","version":"1.0.0","description":"JS-AI","author":"MyBricks","author_name":"MyBricks","icon":"./icon.svg","runtime":"./runtime.ts","editors":"./editors.ts","ai":"./ai.ts","rtType":"js-autorun","visibility":false,"inputs":[{"id":"input","title":"输入项","schema":[{"name":"inputValue0","title":"参数0","type":"follow"}],"editable":true}],"outputs":[{"id":"output0","title":"输出项0","schema":{"type":"unknown"},"editable":true}]}'),d=function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))},f=window.setInterval,_=window.clearInterval,m=window.setTimeout,h=window.clearTimeout,v=window,y=new WeakMap,b=new WeakMap,w=new WeakMap,g={undefined:!0,Array:!0,Object:!0,String:!0,Boolean:!0,Math:!0,Number:!0,Symbol:!0,parseFloat:!0,Float32Array:!0};function k(t){for(;t.trim().endsWith(";");)t=t.slice(0,t.length-1);return t}function j(){var t={};return Object.getOwnPropertyNames(v).forEach((function(e){var n=Object.getOwnPropertyDescriptor(v,e);if(n&&!n.configurable){var r=Object.prototype.hasOwnProperty.call(n,"get");"top"!==e&&"parent"!==e&&"self"!==e&&"window"!==e||(n.configurable=!0,r||(n.writable=!0)),Object.defineProperty(t,e,Object.freeze(n))}})),t}var O=function(){function t(t){void 0===t&&(t={});var e=this;this.hasDisposed=!1,this.fakeWindow=j(),this.timeoutList=[],this.intervalList=[],this.options={},this.options=t||{},this.proxy=new Proxy(window,{set:function(t,n,r){if(!e.hasDisposed)try{!e.fakeWindow.hasOwnProperty(n)&&t.hasOwnProperty(n)&&(o=n,i=e.fakeWindow,(a=Object.getOwnPropertyDescriptor(window,o))&&a.writable&&Object.defineProperty(i,o,{configurable:a.configurable,enumerable:a.enumerable,writable:a.writable,value:a.value})),e.fakeWindow[n]=r}catch(t){throw console.error("set-key-error",n,t),t}var o,i,a;return!0},get:function(t,n){if(n===Symbol.unscopables)return g;if("window"===n||"self"===n)return e.proxy;if("document"!==n){if("hasOwnProperty"===n)return t.hasOwnProperty;if("eval"===n)return t.eval;if("location"===n)return t.location;try{var r=n in e.fakeWindow?e.fakeWindow[n]:t[n];return"function"!=typeof r||function(t){if(b.has(t))return b.get(t);var e=0===t.name.indexOf("bound ")&&!t.hasOwnProperty("prototype");return b.set(t,e),e}(r)||function(t){if(y.has(t))return y.get(t);var e=t.prototype&&t.prototype.constructor===t&&Object.getOwnPropertyNames(t.prototype).length>1||/^function\b\s[A-Z].*/.test(t.toString())||/^class\b/.test(t.toString());return y.set(t,e),e}(r)?r:(r=Function.prototype.bind.call(r,t),function(t,e){var n=w.get(e);if(n)return n;var r=Function.prototype.bind.call(e,t);for(var o in e)r[o]=e[o];return e.hasOwnProperty("prototype")&&!r.hasOwnProperty("prototype")&&(r.prototype=e.prototype),w.set(e,r),r}(window,r))}catch(t){throw console.error("get-key-error",n,t),t}}},has:function(t,n){return!e.options.module||"params"!==n&&"cb"!==n}}),this.proxy.setTimeout=function(t,n){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];if(e.hasDisposed)return 0;var i=m.apply(void 0,d([t,n],r,!1));return e.timeoutList.push(i),i},this.proxy.clearTimeout=function(t){var n=e.timeoutList.indexOf(t);return-1!==n&&e.timeoutList.splice(n,1),h(t)},this.proxy.setInterval=function(t,n){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];if(e.hasDisposed)return 0;var i=f.apply(void 0,d([t,n],r,!1));return e.intervalList.push(i),i},this.proxy.clearInterval=function(t){var n=e.intervalList.indexOf(t);return-1!==n&&e.intervalList.splice(n,1),_(t)},v.proxy=this.proxy}return t.prototype.compile=function(t){if(this.hasDisposed)throw new Error("sandbox has been destroyed");var e,n=this.options.module;e=n?function(t){return t=k(t),"(\n                function(window, params, cb) {\n                    with(window) {\n                        return (".concat(t,")(...params, cb)\n                    }\n                }\n            )")}(t):function(t){return t=k(t),"(\n                function(window) {\n                    with(window){\n                        ".concat(t,"\n                    } \n                }\n            ).bind(window.proxy)\n        ")}(t);var r=v.eval("".concat(e,";//@ sourceURL=sandbox-code.js"));return{run:function(t,e){try{return n?r(window.proxy,t,e):r(window.proxy)}catch(t){throw console.error("js sandbox error occur:",t),t}}}},t.prototype.dispose=function(){this.timeoutList.forEach((function(t){window.clearTimeout(t)})),this.timeoutList=[],this.intervalList.forEach((function(t){return _(t)})),this.intervalList=[],this.fakeWindow=j(),this.options={},delete v.proxy,this.hasDisposed=!0},t}(),x=O,T=function(t){try{return decodeURIComponent(t)}catch(e){return t}},M=function(t){try{return encodeURIComponent(t)}catch(e){return t}};function S(t,e,n){var r,o,i=n||{},a=i.callback,c=void 0===a?function(){}:a,s=i.env,u=void 0===s?{}:s;if(!(null==u?void 0:u.toCode)&&!u.extractFns||!Number.isInteger(t)){var p,l;if("object"==typeof t&&null!==t&&(t=null!==(o=null==t?void 0:t.transformCode)&&void 0!==o?o:null==t?void 0:t.code),(null==t?void 0:t.includes("var%20_RTFN_"))||(t=D(t)),e&&e.length){l=new x({module:!0});var d=T(t);p=/export\s+default.*async.*function.*\(/g.test(d)?l.compile("".concat(d.replace(/export\s+default.*function.*\(/g,"async function _RT_("))):l.compile("".concat(d.replace(/export\s+default.*function.*\(/g,"function _RT_(")))}else p=(l=new x).compile("".concat(T(t)));return p.run(e,c),l}(r=u.extractFns)[t].apply(r,e)}var D=function(t){t=T(t);try{if(!window.Babel)throw Error("Babel was not found in window");var e=window.Babel.transform("_RTFN_ = ".concat(t," "),{presets:["env","typescript"],parserOpts:{strictMode:!1},comments:!1,filename:"types.d.ts"}).code;return e="(function() { var _RTFN_; \n".concat(e,"\n return _RTFN_; })()"),M(e)}catch(e){return console.error(e),M(t)}};function E(t){var e=[];return Object.keys(t).sort((function(t,e){var n,r;return+((null===(n=null==t?void 0:t.match(/\d+/g))||void 0===n?void 0:n[0])||0)-+((null===(r=null==e?void 0:e.match(/\d+/g))||void 0===r?void 0:r[0])||0)})).forEach((function(n){e.push(t[n])})),e}var P=function(){return P=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},P.apply(this,arguments)},C=JSON.parse('{"title":"领域模型","namespace":"mybricks.core-comlib.domain","author":"CheMingjun","author_name":"车明君","version":"1.0.0","description":"领域模型","rtType":"js","data":"./data.json","runtime":"./runtime.ts","editors":"./editor.ts","inputs":[{"id":"call","rels":["then","catch"],"title":"调用","desc":"调用对应领域模型","schema":{"type":"object"}}],"outputs":[{"id":"then","title":"结果","desc":"成功时，领域模型返回信息","schema":{"type":"unknown"}},{"id":"catch","title":"发生错误","desc":"发生错误时，领域模型返回信息","schema":{"type":"string"}}]}'),F={id:"mybricks-core-comlib",title:"Mybrics核心组件库",author:"CheMingjun",icon:"",version:"1.0.1",comAray:[A({comDef:t,rt:function(t){t.inputs,t.outputs}}),A({comDef:e,rt:function(t){t.env;var e=t.data,r=t.outputs,o=t.inputs,i=t._notifyBindings;o.get((function(t,r){var o=n(void 0!==e.val?e.val:e.initValue);r.return(o)})),o.set((function(t,o){e.val=t;var a=n(t);r.changed(a,!0),i(a),o.return(a)})),o.reset((function(){var t=e.initValue;e.val=t;var o=n(t);r.changed(o,!0),i(o)}))}}),A({comDef:r,rt:o.Z}),A({comDef:i,rt:function(t){var e=t.env,n=t.data,r=t.inputs,o=t.outputs,i=t.onError;e.runtime&&(n.immediate?a({env:e,data:n,outputs:o}):r.call((function(t){a({env:e,data:n,outputs:o,onError:i},t)})))}}),A({comDef:c,rt:function(t){var e=t.env,n=t.inputs;e.runtime&&n.getCurValue((function(t,e){e.return(t)}))}}),A({comDef:s,rt:function(t){var e=t.env,n=t.data,r=t.inputs,o=(t._inputs,t._inputsCallable);r[n._pinId||"open"]((function(t){n._pinId&&"open"!==n._pinId?o[n._pinId](t):(e.canvas.open(n._sceneId,t,"popup"===n._sceneShowType?null:n.openType),o._open(t))}))}}),A({comDef:u,rt:function(t){var e=t.id,n=t.env,r=t.data,o=t.inputs,i=t.outputs,a=n.getModuleJSON(r.definedId);return n.renderModule(a,{ref:function(t){var e=a.inputs,n=a.outputs,c=a.pinRels,s={},u={};Object.entries(c).forEach((function(t){var e=t[0],n=t[1],r=e.split("_rootFrame_-")[1];if(r){var o=n[0];s[r]=o,u[o]=!0}}));var p=r.configs;for(var l in p)t.inputs[l](p[l]);n.forEach((function(e){var n=e.id;u[n]||t.outputs(n,i[n])})),e.forEach((function(e){var n=e.id;o[n]((function(e,r){var o=s[n];o&&t.outputs(o,(function(t){r[o](t)})),t.inputs[n](e)}))})),t.run()},disableAutoRun:!0,outputs:i,rootId:e})}}),A({comDef:p,rt:function(t){t.inputs,t.outputs}}),A({comDef:l,rt:function(t){var e,n,r=t.env,o=t.data,i=t.inputs,a=t.outputs,c=t.logger,s=t.onError,u=o.fns,p=o.runImmediate,l={outputs:E(a)};try{p&&r.runtime&&(n=S(u,[l],{env:r})),i.input((function(t){try{n=S(u,[P(P({},l),{inputs:E(t)})],{env:r})}catch(t){null==s||s(t),console.error("js计算组件运行错误.",t),c.error("".concat(t))}})),"function"==typeof(null===(e=null==r?void 0:r.runtime)||void 0===e?void 0:e.onComplete)&&r.runtime.onComplete((function(){null==n||n.dispose()}))}catch(t){null==s||s(t),console.error("js计算组件运行错误.",t),c.error("".concat(t))}}}),A({comDef:C,rt:function(t){var e=t.env,n=t.data;t.inputs.call((function(t,r){n.model?e.callDomainModel?e.callDomainModel({model:n.model,params:t,configs:{callType:"call"}},(function(t,e,n){e||(t?r.catch(t):r.then(n))})):r.catch("未实现env.callDomainModel"):r.catch("没有选择领域模型")}))}})]},N=F;function I(t){return F.comAray.find((function(e){return e.namespace===t}))}function A(t){var e=t.comDef,n=t.rt,r=t.data;return Object.assign(e,{runtime:n,data:r})}}(),__webpack_exports__}()}));